{% extends 'base.html' %}
{% block title %}Welcome!{% endblock %}
{% load streak_tags %}
{% load staticfiles %}

{% block app %}ng-app="streakApp"{% endblock %}

{% block content %}
 {# Top block #}
  <h1 class="streak_headline">
  {% if user.first_name %}
  {{ user.first_name }}'s Streaks
  {% else %}
  {{ user }}'s Streaks
  {% endif %}
  </h1>
  <h4 class="streak_headline">Please note: this is a prototype interface</h4>

  <div id="add_form">
  {{ addform }}
  <button id="add_form_hide">Close</button>
  </div>

  {# Account options #}
  <div id="dash_options">
  <hr>
  <h3>Account options</h3>
  <span><a href="/accounts/email/">Email options</a></span> |
  <span><a href="/accounts/password/change/">Change password</a></span> |
  <span>Email status: {% if request.user.profile.account_verified %}
  Verified {% else %} Unverified {% endif %}</span>
  <br /><br />
  <button id="account_options_hide">Close</button>
  <hr>
  </div>

  <div class="messages" id="error">
  <p>I'm sorry, there was an error.</p>
  </div>

  {# Streaks #}
  <div class="streaks" ng-controller="StreakCtrl as ctrl">
  <form ng-submit="newStreak.$save()">
      <fieldset>
        <legend>Add an activity</legend>
        <input ng-model="newStreak.user" />
        <input ng-model="newStreak.activity" placeholder="Activity" />
        <input ng-model="newStreak.start" placeholder="Start" />
        <input ng-model="newStreak.current_streak" placeholder="Current streak" />
        <button type="submit">Add</button>
      </fieldset>
  </form>

  {% verbatim %}
  <h4>Current streaks: {{ streak.length }}</h4>
  <div ng-repeat="user_streak in streak">
  <hr>
  <h3>{{ user_streak.activity }}</h3>
  <p>Start: {{ user_streak.start }}</p>
  <p>Longest: {{ user_streak.current_streak }}</p>
  <p>Current: {{ user_streak.longest_streak }}</p>
  <p>Resets: {{ user_streak.resets }}</p>
  <p>Last reset: {{ user_streak.last_reset | date }}</p>
  <p>Notes: {{ user_streak.notes }}</p>
  <hr>
  </div>
  {% endverbatim %}
  </div>

{% endblock %}

{% block scripts %}

<script src="{% static 'vendor/angular.min.js' %}"></script>
<script src="{% static 'vendor/angular-resource.min.js' %}"></script>
<script src="{% static 'vendor/angular-route.min.js' %}"></script>
<script src="{% static 'vendor/angular-cookies.min.js' %}"></script>
<script src="{% static 'js/custom.js' %}"></script>
<script src="{% static 'js/app.js' %}"></script>
<script src="{% static 'js/controllers/streaks.js' %}"></script>
<script src="{% static 'vendor/angular-django-rest-resource.js' %}"></script>

{% endblock %}

{% block auth-buttons %}

<li><a href="/logout">Logout</a></li>

{% endblock %}